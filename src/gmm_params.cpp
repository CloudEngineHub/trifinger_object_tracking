/**
 * @file
 * @copyright 2020, Max Planck Gesellschaft. All rights reserved.
 * @license BSD 3-clause
 */
#pragma once

#include <trifinger_object_tracking/gmm_params.hpp>

namespace trifinger_object_tracking
{
arma::gmm_full update_gmm_model(arma::gmm_full model, const std::string &color)
{
    GmmParam params;
    params.color = color;

    std::cout << color << std::endl;

    if (color.compare("blue") == 0)
    {
        params.hefts = arma::rowvec({0.0307782,
                                     0.31900028,
                                     0.00671689,
                                     0.13367775,
                                     0.05666897,
                                     0.4531579});
        params.means = arma::mat(
            {{101.26498683, 55.70885368, 0., 103.33368565, 255., 101.26498683},
             {119.3176366, 59.93127392, 0., 104.88666249, 255., 119.3176366},
             {68.49700796,
              58.51694685,
              30.37103259,
              99.81140798,
              150.52602788,
              73.03421703},
             {154.20600054, 75.58786771, 0., 105.30772796, 255., 154.20600054},
             {99.95789539,
              53.49697607,
              13.62298845,
              106.29182676,
              220.2023779,
              99.95789539},
             {95.57316442, 50.49840772, 0., 104.12210124, 255., 95.57316442}});
        params.means = params.means.t();  // to store info in a column vector
                                          // for each single gaussian

        params.fcovs = arma::cube(6, 6, params.hefts.n_elem);

        params.fcovs.slice(0) = arma::mat({{7.37735919e+02,
                                            3.74720548e+02,
                                            0.00000000e+00,
                                            1.68635461e+01,
                                            2.78406364e-23,
                                            7.37735918e+02},
                                           {3.74720548e+02,
                                            6.36587440e+02,
                                            0.00000000e+00,
                                            -1.19925667e+02,
                                            1.52922463e-23,
                                            3.74720548e+02},
                                           {0.00000000e+00,
                                            0.00000000e+00,
                                            1.00000000e-06,
                                            0.00000000e+00,
                                            0.00000000e+00,
                                            0.00000000e+00},
                                           {1.68635461e+01,
                                            -1.19925667e+02,
                                            0.00000000e+00,
                                            3.97796475e+01,
                                            2.76048380e-23,
                                            1.68635461e+01},
                                           {2.78628471e-23,
                                            1.53047588e-23,
                                            0.00000000e+00,
                                            2.76024801e-23,
                                            1.00000000e-06,
                                            2.78500683e-23},
                                           {7.37735918e+02,
                                            3.74720548e+02,
                                            0.00000000e+00,
                                            1.68635461e+01,
                                            2.78406364e-23,
                                            7.37735919e+02}});

        params.fcovs.slice(1) = arma::mat({{1.34880169e+02,
                                            5.00692214e+01,
                                            0.00000000e+00,
                                            4.50619204e+00,
                                            2.42250792e-23,
                                            1.34880168e+02},
                                           {5.00692214e+01,
                                            3.83646632e+01,
                                            0.00000000e+00,
                                            -3.15110668e+00,
                                            1.18858890e-23,
                                            5.00692214e+01},
                                           {0.00000000e+00,
                                            0.00000000e+00,
                                            1.00000000e-06,
                                            0.00000000e+00,
                                            0.00000000e+00,
                                            0.00000000e+00},
                                           {4.50619204e+00,
                                            -3.15110668e+00,
                                            0.00000000e+00,
                                            1.41147442e+00,
                                            2.05996894e-23,
                                            4.50619204e+00},
                                           {2.42249333e-23,
                                            1.18838804e-23,
                                            0.00000000e+00,
                                            2.05998520e-23,
                                            1.00000000e-06,
                                            2.42250810e-23},
                                           {1.34880168e+02,
                                            5.00692214e+01,
                                            0.00000000e+00,
                                            4.50619204e+00,
                                            2.42250792e-23,
                                            1.34880169e+02}});

        params.fcovs.slice(2) = arma::mat({{2.82189874e+02,
                                            1.30735949e+02,
                                            3.05551214e+01,
                                            7.37558132e+01,
                                            2.97995629e+02,
                                            2.76435867e+02},
                                           {1.30735949e+02,
                                            6.20626063e+02,
                                            -1.80833007e+02,
                                            -3.46521619e+02,
                                            5.19389258e+02,
                                            2.47954002e+02},
                                           {3.05551214e+01,
                                            -1.80833007e+02,
                                            4.25920867e+02,
                                            1.30465436e+02,
                                            -1.39320672e+03,
                                            -4.04100977e+01},
                                           {7.37558132e+01,
                                            -3.46521619e+02,
                                            1.30465436e+02,
                                            4.74469183e+02,
                                            -1.50609041e+02,
                                            -8.55156992e+00},
                                           {2.97995629e+02,
                                            5.19389258e+02,
                                            -1.39320672e+03,
                                            -1.50609041e+02,
                                            5.73847298e+03,
                                            5.42694684e+02},
                                           {2.76435867e+02,
                                            2.47954002e+02,
                                            -4.04100977e+01,
                                            -8.55156992e+00,
                                            5.42694684e+02,
                                            3.28370880e+02}});

        params.fcovs.slice(3) = arma::mat({{6.99439248e+00,
                                            4.92265624e-01,
                                            0.00000000e+00,
                                            5.60687363e-01,
                                            8.70358630e-24,
                                            6.99439148e+00},
                                           {4.92265624e-01,
                                            1.88232664e+01,
                                            0.00000000e+00,
                                            -3.60474955e+00,
                                            4.02386543e-24,
                                            4.92265624e-01},
                                           {0.00000000e+00,
                                            0.00000000e+00,
                                            1.00000000e-06,
                                            0.00000000e+00,
                                            0.00000000e+00,
                                            0.00000000e+00},
                                           {5.60687363e-01,
                                            -3.60474955e+00,
                                            0.00000000e+00,
                                            8.33670623e-01,
                                            5.70794784e-24,
                                            5.60687363e-01},
                                           {8.70339968e-24,
                                            4.02461822e-24,
                                            0.00000000e+00,
                                            5.70768510e-24,
                                            1.00000000e-06,
                                            8.70358631e-24},
                                           {6.99439148e+00,
                                            4.92265624e-01,
                                            0.00000000e+00,
                                            5.60687363e-01,
                                            8.70358630e-24,
                                            6.99439248e+00}});

        params.fcovs.slice(4) = arma::mat({{3.93383497e+02,
                                            1.81285635e+02,
                                            3.89574275e+01,
                                            4.99223177e+00,
                                            2.03787211e+01,
                                            3.93383496e+02},
                                           {1.81285635e+02,
                                            2.97409231e+02,
                                            7.90089585e+01,
                                            -5.93429382e+01,
                                            -1.51772036e+02,
                                            1.81285635e+02},
                                           {3.89574275e+01,
                                            7.90089585e+01,
                                            1.87828409e+02,
                                            1.71500048e+01,
                                            -4.61995079e+02,
                                            3.89574275e+01},
                                           {4.99223177e+00,
                                            -5.93429382e+01,
                                            1.71500048e+01,
                                            2.65560509e+01,
                                            -3.92599384e+01,
                                            4.99223177e+00},
                                           {2.03787211e+01,
                                            -1.51772036e+02,
                                            -4.61995079e+02,
                                            -3.92599384e+01,
                                            1.21462743e+03,
                                            2.03787211e+01},
                                           {3.93383496e+02,
                                            1.81285635e+02,
                                            3.89574275e+01,
                                            4.99223177e+00,
                                            2.03787211e+01,
                                            3.93383497e+02}});

        params.fcovs.slice(5) = arma::mat({{6.02360004e+01,
                                            3.21486351e+01,
                                            0.00000000e+00,
                                            1.08254916e-01,
                                            3.02063603e-25,
                                            6.02359994e+01},
                                           {3.21486351e+01,
                                            4.45900680e+01,
                                            0.00000000e+00,
                                            -8.65478222e+00,
                                            1.76932635e-25,
                                            3.21486351e+01},
                                           {0.00000000e+00,
                                            0.00000000e+00,
                                            1.00000000e-06,
                                            0.00000000e+00,
                                            0.00000000e+00,
                                            0.00000000e+00},
                                           {1.08254916e-01,
                                            -8.65478222e+00,
                                            0.00000000e+00,
                                            2.85179782e+00,
                                            3.74894362e-25,
                                            1.08254916e-01},
                                           {3.01991276e-25,
                                            1.76103457e-25,
                                            0.00000000e+00,
                                            3.74804921e-25,
                                            1.00000000e-06,
                                            3.16420523e-25},
                                           {6.02359994e+01,
                                            3.21486351e+01,
                                            0.00000000e+00,
                                            1.08254916e-01,
                                            3.16498016e-25,
                                            6.02360004e+01}});
    }

    if (color.compare("cyan") == 0)
    {
        params.hefts = arma::rowvec({0.20211856,
                                     0.36876394,
                                     0.25766052,
                                     0.02381337,
                                     0.03631001,
                                     0.1113336});
        params.means = arma::mat(
            {{103.71487252, 92.34668077, 0., 93.23060696, 255., 103.71487252},
             {166.54380763,
              145.49758118,
              41.4060057,
              95.06516899,
              191.6770655,
              166.54380763},
             {102.26286756,
              92.43149651,
              13.65167705,
              93.29551437,
              221.07525112,
              102.26286756},
             {94.80564116,
              108.21678501,
              31.5031624,
              83.01192299,
              182.08279608,
              108.38101071},
             {118.81348127,
              93.08990977,
              48.22876545,
              101.36697771,
              153.16900101,
              118.81348127},
             {118.86767269,
              107.24374773,
              44.56258297,
              94.67014401,
              160.6571475,
              118.86767269}});
        params.means = params.means.t();  // to store info in a column vector
                                          // for each single gaussian

        params.fcovs = arma::cube(6, 6, params.hefts.n_elem);

        params.fcovs.slice(0) = arma::mat({{2.03993848e+02,
                                            1.63519323e+02,
                                            0.00000000e+00,
                                            5.43615672e+00,
                                            7.65591994e-23,
                                            2.03993847e+02},
                                           {1.63519323e+02,
                                            1.48451348e+02,
                                            0.00000000e+00,
                                            -7.46243009e-01,
                                            6.91649852e-23,
                                            1.63519323e+02},
                                           {0.00000000e+00,
                                            0.00000000e+00,
                                            1.00000000e-06,
                                            0.00000000e+00,
                                            0.00000000e+00,
                                            0.00000000e+00},
                                           {5.43615672e+00,
                                            -7.46243009e-01,
                                            0.00000000e+00,
                                            1.77042936e+00,
                                            6.94218133e-23,
                                            5.43615672e+00},
                                           {7.65730721e-23,
                                            6.91510649e-23,
                                            0.00000000e+00,
                                            6.94211112e-23,
                                            1.00000000e-06,
                                            7.65672151e-23},
                                           {2.03993847e+02,
                                            1.63519323e+02,
                                            0.00000000e+00,
                                            5.43615672e+00,
                                            7.65591994e-23,
                                            2.03993848e+02}});

        params.fcovs.slice(1) = arma::mat({{2.70007510e+01,
                                            1.71740921e+01,
                                            1.27822411e+01,
                                            1.74413231e+00,
                                            -9.29051955e+00,
                                            2.70007500e+01},
                                           {1.71740921e+01,
                                            1.93464054e+01,
                                            1.65566390e+01,
                                            -5.78181447e-01,
                                            -1.87892432e+01,
                                            1.71740921e+01},
                                           {1.27822411e+01,
                                            1.65566390e+01,
                                            1.03864981e+02,
                                            2.59466078e+00,
                                            -1.54686532e+02,
                                            1.27822411e+01},
                                           {1.74413231e+00,
                                            -5.78181447e-01,
                                            2.59466078e+00,
                                            6.73244848e-01,
                                            -3.32418401e+00,
                                            1.74413231e+00},
                                           {-9.29051955e+00,
                                            -1.87892432e+01,
                                            -1.54686532e+02,
                                            -3.32418401e+00,
                                            2.34370438e+02,
                                            -9.29051955e+00},
                                           {2.70007500e+01,
                                            1.71740921e+01,
                                            1.27822411e+01,
                                            1.74413231e+00,
                                            -9.29051955e+00,
                                            2.70007510e+01}});

        params.fcovs.slice(2) = arma::mat({{7.59078263e+01,
                                            5.68074917e+01,
                                            1.30164263e+01,
                                            4.18127635e+00,
                                            -1.00540713e+01,
                                            7.59078253e+01},
                                           {5.68074917e+01,
                                            5.32183377e+01,
                                            1.46297710e+01,
                                            -3.40463505e-01,
                                            -1.96332030e+01,
                                            5.68074917e+01},
                                           {1.30164263e+01,
                                            1.46297710e+01,
                                            6.12734476e+01,
                                            1.34663945e+00,
                                            -1.49019865e+02,
                                            1.30164263e+01},
                                           {4.18127635e+00,
                                            -3.40463505e-01,
                                            1.34663945e+00,
                                            1.54545471e+00,
                                            -2.13648693e+00,
                                            4.18127635e+00},
                                           {-1.00540713e+01,
                                            -1.96332030e+01,
                                            -1.49019865e+02,
                                            -2.13648693e+00,
                                            3.70997098e+02,
                                            -1.00540713e+01},
                                           {7.59078253e+01,
                                            5.68074917e+01,
                                            1.30164263e+01,
                                            4.18127635e+00,
                                            -1.00540713e+01,
                                            7.59078263e+01}});

        params.fcovs.slice(3) = arma::mat({{9.12890410e+02,
                                            9.36997183e+02,
                                            3.26143200e+02,
                                            7.87460358e+01,
                                            -6.44151349e+01,
                                            9.33025480e+02},
                                           {9.36997183e+02,
                                            1.17322987e+03,
                                            3.39789827e+02,
                                            1.45755679e+01,
                                            3.43279568e+01,
                                            1.16688213e+03},
                                           {3.26143200e+02,
                                            3.39789827e+02,
                                            8.99052789e+02,
                                            -1.27580538e+02,
                                            -1.80936254e+03,
                                            3.47934998e+02},
                                           {7.87460358e+01,
                                            1.45755679e+01,
                                            -1.27580538e+02,
                                            2.20674220e+02,
                                            3.51062728e+02,
                                            1.75341022e+01},
                                           {-6.44151349e+01,
                                            3.43279568e+01,
                                            -1.80936254e+03,
                                            3.51062728e+02,
                                            4.55407630e+03,
                                            1.20482385e+01},
                                           {9.33025480e+02,
                                            1.16688213e+03,
                                            3.47934998e+02,
                                            1.75341022e+01,
                                            1.20482385e+01,
                                            1.16243704e+03}});

        params.fcovs.slice(4) = arma::mat({{1.15508703e+03,
                                            8.95114476e+02,
                                            5.42761153e+02,
                                            2.94271358e+01,
                                            -1.09371219e+02,
                                            1.15508703e+03},
                                           {8.95114476e+02,
                                            9.89353829e+02,
                                            5.99514611e+02,
                                            -7.38588649e+01,
                                            -4.86476618e+02,
                                            8.95114476e+02},
                                           {5.42761153e+02,
                                            5.99514611e+02,
                                            9.65566042e+02,
                                            6.44852239e+01,
                                            -1.50059044e+03,
                                            5.42761153e+02},
                                           {2.94271358e+01,
                                            -7.38588649e+01,
                                            6.44852239e+01,
                                            6.75986501e+01,
                                            -8.99638087e+01,
                                            2.94271358e+01},
                                           {-1.09371219e+02,
                                            -4.86476618e+02,
                                            -1.50059044e+03,
                                            -8.99638087e+01,
                                            3.19223790e+03,
                                            -1.09371219e+02},
                                           {1.15508703e+03,
                                            8.95114476e+02,
                                            5.42761153e+02,
                                            2.94271358e+01,
                                            -1.09371219e+02,
                                            1.15508703e+03}});

        params.fcovs.slice(5) = arma::mat({{2.12576030e+02,
                                            1.78101216e+02,
                                            1.49803191e+02,
                                            1.08137301e+01,
                                            -1.50449961e+02,
                                            2.12576029e+02},
                                           {1.78101216e+02,
                                            1.63316463e+02,
                                            1.36234887e+02,
                                            3.91394119e+00,
                                            -1.48788382e+02,
                                            1.78101216e+02},
                                           {1.49803191e+02,
                                            1.36234887e+02,
                                            1.85665400e+02,
                                            8.36440931e+00,
                                            -2.72348442e+02,
                                            1.49803191e+02},
                                           {1.08137301e+01,
                                            3.91394119e+00,
                                            8.36440931e+00,
                                            2.85035955e+00,
                                            -9.02797796e+00,
                                            1.08137301e+01},
                                           {-1.50449961e+02,
                                            -1.48788382e+02,
                                            -2.72348442e+02,
                                            -9.02797796e+00,
                                            4.55357088e+02,
                                            -1.50449961e+02},
                                           {2.12576029e+02,
                                            1.78101216e+02,
                                            1.49803191e+02,
                                            1.08137301e+01,
                                            -1.50449961e+02,
                                            2.12576030e+02}});
    }

    if (color.compare("red") == 0)
    {
        params.hefts =
            arma::rowvec({0.05192667, 0.3755583, 0.56020869, 0.01230634});
        params.means = arma::mat(
            {{0., 29.62287608, 211.94847104, 4.1859653, 255., 211.94847104},
             {0., 0., 229.13287709, 0., 255., 229.13287709},
             {0., 64.11513572, 255., 7.53702785, 255., 255.},
             {44.23840914,
              52.52230835,
              220.72336731,
              71.40006972,
              216.59878728,
              220.72336731}});

        params.means = params.means.t();  // to store info in a column vector
                                          // for each single gaussian

        params.fcovs = arma::cube(6, 6, params.hefts.n_elem);

        params.fcovs.slice(0) = arma::mat({{1.00000000e-06,
                                            0.00000000e+00,
                                            0.00000000e+00,
                                            0.00000000e+00,
                                            0.00000000e+00,
                                            0.00000000e+00},
                                           {0.00000000e+00,
                                            7.68762677e+02,
                                            9.94898918e+01,
                                            1.06072512e+02,
                                            9.88395713e-23,
                                            9.94898918e+01},
                                           {0.00000000e+00,
                                            9.94898918e+01,
                                            6.27863866e+02,
                                            8.46459892e-01,
                                            7.14911815e-22,
                                            6.27863865e+02},
                                           {0.00000000e+00,
                                            1.06072512e+02,
                                            8.46459892e-01,
                                            1.51774020e+01,
                                            1.41015694e-23,
                                            8.46459892e-01},
                                           {0.00000000e+00,
                                            9.88862076e-23,
                                            7.15000166e-22,
                                            1.41101512e-23,
                                            1.00000000e-06,
                                            7.14893937e-22},
                                           {0.00000000e+00,
                                            9.94898918e+01,
                                            6.27863865e+02,
                                            8.46459892e-01,
                                            7.14911815e-22,
                                            6.27863866e+02}});

        params.fcovs.slice(1) = arma::mat({{1.00000000e-06,
                                            0.00000000e+00,
                                            0.00000000e+00,
                                            0.00000000e+00,
                                            0.00000000e+00,
                                            0.00000000e+00},
                                           {0.00000000e+00,
                                            1.00000000e-06,
                                            0.00000000e+00,
                                            0.00000000e+00,
                                            0.00000000e+00,
                                            0.00000000e+00},
                                           {0.00000000e+00,
                                            0.00000000e+00,
                                            5.57430174e+02,
                                            0.00000000e+00,
                                            2.26999004e-21,
                                            5.57430173e+02},
                                           {0.00000000e+00,
                                            0.00000000e+00,
                                            0.00000000e+00,
                                            1.00000000e-06,
                                            0.00000000e+00,
                                            0.00000000e+00},
                                           {0.00000000e+00,
                                            0.00000000e+00,
                                            2.26950163e-21,
                                            0.00000000e+00,
                                            1.00000000e-06,
                                            2.26989990e-21},
                                           {0.00000000e+00,
                                            0.00000000e+00,
                                            5.57430173e+02,
                                            0.00000000e+00,
                                            2.26999004e-21,
                                            5.57430174e+02}});

        params.fcovs.slice(2) = arma::mat({{1.00000000e-06,
                                            0.00000000e+00,
                                            0.00000000e+00,
                                            0.00000000e+00,
                                            0.00000000e+00,
                                            0.00000000e+00},
                                           {0.00000000e+00,
                                            1.08230402e+03,
                                            3.00746773e-22,
                                            1.27527780e+02,
                                            3.00746773e-22,
                                            3.00746773e-22},
                                           {0.00000000e+00,
                                            3.00766120e-22,
                                            1.00000000e-06,
                                            3.55682111e-23,
                                            1.19641417e-21,
                                            1.19641417e-21},
                                           {0.00000000e+00,
                                            1.27527780e+02,
                                            3.55685483e-23,
                                            1.51086627e+01,
                                            3.55685483e-23,
                                            3.55685483e-23},
                                           {0.00000000e+00,
                                            3.00572502e-22,
                                            1.19641417e-21,
                                            3.55952459e-23,
                                            1.00000000e-06,
                                            1.19641417e-21},
                                           {0.00000000e+00,
                                            3.00572502e-22,
                                            1.19641417e-21,
                                            3.55952459e-23,
                                            1.19641417e-21,
                                            1.00000000e-06}});

        params.fcovs.slice(3) = arma::mat({{4.90694897e+02,
                                            2.36662418e+01,
                                            9.69220209e+00,
                                            7.24851897e+02,
                                            -3.20184311e+02,
                                            9.69220209e+00},
                                           {2.36662418e+01,
                                            1.12046809e+03,
                                            3.38112739e+02,
                                            -1.67305940e+03,
                                            -3.91981243e+02,
                                            3.38112739e+02},
                                           {9.69220209e+00,
                                            3.38112739e+02,
                                            1.14192011e+03,
                                            -5.21357762e+02,
                                            1.19701963e+02,
                                            1.14192011e+03},
                                           {7.24851897e+02,
                                            -1.67305940e+03,
                                            -5.21357762e+02,
                                            6.91083114e+03,
                                            3.76295856e+02,
                                            -5.21357762e+02},
                                           {-3.20184311e+02,
                                            -3.91981243e+02,
                                            1.19701963e+02,
                                            3.76295856e+02,
                                            5.90683117e+02,
                                            1.19701963e+02},
                                           {9.69220209e+00,
                                            3.38112739e+02,
                                            1.14192011e+03,
                                            -5.21357762e+02,
                                            1.19701963e+02,
                                            1.14192011e+03}});
    }

    if (color.compare("magenta") == 0)
    {
        params.hefts =
            arma::rowvec({0.54476057, 0.16993937, 0.26531312, 0.01998694});
        params.means = arma::mat({{106.87361345,
                                   54.19960904,
                                   188.56220511,
                                   168.23576085,
                                   181.66709764,
                                   188.56220511},
                                  {89.35271518,
                                   51.51402322,
                                   161.0472382,
                                   169.72100597,
                                   173.91506229,
                                   161.0472382},
                                  {62.89803274,
                                   29.88381314,
                                   130.51050155,
                                   170.25689442,
                                   196.66501565,
                                   130.51050155},
                                  {69.50376031,
                                   57.03065506,
                                   142.95822707,
                                   93.6368544,
                                   160.54690226,
                                   143.37544027}});

        params.means = params.means.t();  // to store info in a column vector
                                          // for each single gaussian

        params.fcovs = arma::cube(6, 6, params.hefts.n_elem);

        params.fcovs.slice(0) = arma::mat({{7.88824646e+01,
                                            3.52263422e+01,
                                            6.86344179e+01,
                                            -6.74130959e+00,
                                            -2.15307124e+01,
                                            6.86344179e+01},
                                           {3.52263422e+01,
                                            4.89361811e+01,
                                            3.56133088e+01,
                                            1.94990652e+00,
                                            -5.27175326e+01,
                                            3.56133088e+01},
                                           {6.86344179e+01,
                                            3.56133088e+01,
                                            1.48218983e+02,
                                            2.57030830e+00,
                                            8.77701785e+00,
                                            1.48218982e+02},
                                           {-6.74130959e+00,
                                            1.94990652e+00,
                                            2.57030830e+00,
                                            2.08412262e+00,
                                            -1.62613639e+00,
                                            2.57030830e+00},
                                           {-2.15307124e+01,
                                            -5.27175326e+01,
                                            8.77701785e+00,
                                            -1.62613639e+00,
                                            7.52268229e+01,
                                            8.77701785e+00},
                                           {6.86344179e+01,
                                            3.56133088e+01,
                                            1.48218982e+02,
                                            2.57030830e+00,
                                            8.77701785e+00,
                                            1.48218983e+02}});

        params.fcovs.slice(1) = arma::mat({{2.28101974e+02,
                                            1.45720401e+02,
                                            1.35105621e+02,
                                            -2.44186689e+01,
                                            -1.51676405e+02,
                                            1.35105621e+02},
                                           {1.45720401e+02,
                                            2.24365586e+02,
                                            1.21954776e+02,
                                            1.13268075e+01,
                                            -2.81850150e+02,
                                            1.21954776e+02},
                                           {1.35105621e+02,
                                            1.21954776e+02,
                                            1.95908116e+02,
                                            2.91277808e+00,
                                            -7.85178164e+01,
                                            1.95908115e+02},
                                           {-2.44186689e+01,
                                            1.13268075e+01,
                                            2.91277808e+00,
                                            9.32025610e+00,
                                            -1.58605627e+01,
                                            2.91277808e+00},
                                           {-1.51676405e+02,
                                            -2.81850150e+02,
                                            -7.85178164e+01,
                                            -1.58605627e+01,
                                            3.99241614e+02,
                                            -7.85178164e+01},
                                           {1.35105621e+02,
                                            1.21954776e+02,
                                            1.95908115e+02,
                                            2.91277808e+00,
                                            -7.85178164e+01,
                                            1.95908116e+02}});

        params.fcovs.slice(2) = arma::mat({{1.05143444e+02,
                                            3.31524055e+01,
                                            6.60561027e+01,
                                            -1.84329199e+01,
                                            -3.66338598e+01,
                                            6.60561027e+01},
                                           {3.31524055e+01,
                                            7.54081216e+01,
                                            3.03292718e+01,
                                            8.29694739e+00,
                                            -1.35873978e+02,
                                            3.03292718e+01},
                                           {6.60561027e+01,
                                            3.03292718e+01,
                                            1.21422517e+02,
                                            -1.90319768e+00,
                                            -6.62973623e+00,
                                            1.21422516e+02},
                                           {-1.84329199e+01,
                                            8.29694739e+00,
                                            -1.90319768e+00,
                                            7.22853951e+00,
                                            -1.73290462e+01,
                                            -1.90319768e+00},
                                           {-3.66338598e+01,
                                            -1.35873978e+02,
                                            -6.62973623e+00,
                                            -1.73290462e+01,
                                            2.67380470e+02,
                                            -6.62973623e+00},
                                           {6.60561027e+01,
                                            3.03292718e+01,
                                            1.21422516e+02,
                                            -1.90319768e+00,
                                            -6.62973623e+00,
                                            1.21422517e+02}});

        params.fcovs.slice(3) = arma::mat({{9.89735582e+02,
                                            3.16728405e+02,
                                            1.15242922e+02,
                                            1.17118160e+03,
                                            -9.25764962e+02,
                                            1.32481645e+02},
                                           {3.16728405e+02,
                                            8.46417954e+02,
                                            4.58746698e+01,
                                            -9.02505914e+02,
                                            -1.10733726e+03,
                                            5.50542845e+01},
                                           {1.15242922e+02,
                                            4.58746698e+01,
                                            1.68625151e+03,
                                            -3.00398613e+02,
                                            1.07004982e+03,
                                            1.66592849e+03},
                                           {1.17118160e+03,
                                            -9.02505914e+02,
                                            -3.00398613e+02,
                                            6.35610118e+03,
                                            -1.14779352e+02,
                                            -2.86988623e+02},
                                           {-9.25764962e+02,
                                            -1.10733726e+03,
                                            1.07004982e+03,
                                            -1.14779352e+02,
                                            3.08264669e+03,
                                            1.03987312e+03},
                                           {1.32481645e+02,
                                            5.50542845e+01,
                                            1.66592849e+03,
                                            -2.86988623e+02,
                                            1.03987312e+03,
                                            1.65311649e+03}});
    }

    if (color.compare("green") == 0)
    {
        params.hefts =
            arma::rowvec({0.74934838, 0.21358641, 0.01997816, 0.01708705});
        params.means = arma::mat(
            {{0., 129.67446294, 0., 60., 255., 129.67446294},
             {0., 198.49580529, 0., 60., 255., 198.49580529},
             {33.85616782, 118.52214028, 0., 68.95917113, 255., 118.52214028},
             {21.82754881,
              112.38177874,
              38.60737527,
              56.31127983,
              214.32212581,
              112.74403471}});

        params.means = params.means.t();  // to store info in a column vector
                                          // for each single gaussian

        params.fcovs = arma::cube(6, 6, params.hefts.n_elem);

        params.fcovs.slice(0) = arma::mat({{1.00000000e-06,
                                            0.00000000e+00,
                                            0.00000000e+00,
                                            0.00000000e+00,
                                            0.00000000e+00,
                                            0.00000000e+00},
                                           {0.00000000e+00,
                                            1.95817678e+02,
                                            0.00000000e+00,
                                            2.80464221e-23,
                                            1.21805953e-22,
                                            1.95817677e+02},
                                           {0.00000000e+00,
                                            0.00000000e+00,
                                            1.00000000e-06,
                                            0.00000000e+00,
                                            0.00000000e+00,
                                            0.00000000e+00},
                                           {0.00000000e+00,
                                            2.80474041e-23,
                                            0.00000000e+00,
                                            1.00000000e-06,
                                            5.46185581e-23,
                                            2.80474041e-23},
                                           {0.00000000e+00,
                                            1.21830502e-22,
                                            0.00000000e+00,
                                            5.46185581e-23,
                                            1.00000000e-06,
                                            1.21813809e-22},
                                           {0.00000000e+00,
                                            1.95817677e+02,
                                            0.00000000e+00,
                                            2.80277649e-23,
                                            1.21805953e-22,
                                            1.95817678e+02}});

        params.fcovs.slice(1) = arma::mat({{1.00000000e-06,
                                            0.00000000e+00,
                                            0.00000000e+00,
                                            0.00000000e+00,
                                            0.00000000e+00,
                                            0.00000000e+00},
                                           {0.00000000e+00,
                                            2.27584152e+01,
                                            0.00000000e+00,
                                            2.19795972e-24,
                                            9.14799675e-24,
                                            2.27584142e+01},
                                           {0.00000000e+00,
                                            0.00000000e+00,
                                            1.00000000e-06,
                                            0.00000000e+00,
                                            0.00000000e+00,
                                            0.00000000e+00},
                                           {0.00000000e+00,
                                            2.19796000e-24,
                                            0.00000000e+00,
                                            1.00000000e-06,
                                            3.07890518e-24,
                                            2.19796000e-24},
                                           {0.00000000e+00,
                                            9.15574602e-24,
                                            0.00000000e+00,
                                            3.07890518e-24,
                                            1.00000000e-06,
                                            9.14799675e-24},
                                           {0.00000000e+00,
                                            2.27584142e+01,
                                            0.00000000e+00,
                                            2.19839064e-24,
                                            9.14799675e-24,
                                            2.27584152e+01}});

        params.fcovs.slice(2) = arma::mat({{3.92382052e+02,
                                            1.53069773e+02,
                                            0.00000000e+00,
                                            9.09768033e+01,
                                            1.45568046e-22,
                                            1.53069773e+02},
                                           {1.53069773e+02,
                                            1.07862076e+03,
                                            0.00000000e+00,
                                            -4.56797420e+01,
                                            5.08564968e-22,
                                            1.07862076e+03},
                                           {0.00000000e+00,
                                            0.00000000e+00,
                                            1.00000000e-06,
                                            0.00000000e+00,
                                            0.00000000e+00,
                                            0.00000000e+00},
                                           {9.09768033e+01,
                                            -4.56797420e+01,
                                            0.00000000e+00,
                                            3.03453437e+01,
                                            2.96341164e-22,
                                            -4.56797420e+01},
                                           {1.45595478e-22,
                                            5.08549238e-22,
                                            0.00000000e+00,
                                            2.96323420e-22,
                                            1.00000000e-06,
                                            5.08571491e-22},
                                           {1.53069773e+02,
                                            1.07862076e+03,
                                            0.00000000e+00,
                                            -4.56797420e+01,
                                            5.08564968e-22,
                                            1.07862076e+03}});

        params.fcovs.slice(3) = arma::mat({{7.22984361e+02,
                                            -1.74725919e+02,
                                            2.56745740e+02,
                                            1.86082965e+02,
                                            -1.26501061e+03,
                                            -1.61766484e+02},
                                           {-1.74725919e+02,
                                            1.31688461e+03,
                                            2.48712803e+02,
                                            -7.20776253e+01,
                                            4.71033201e+02,
                                            1.30485369e+03},
                                           {2.56745740e+02,
                                            2.48712803e+02,
                                            6.66320901e+02,
                                            -1.09679302e+02,
                                            -6.47990662e+02,
                                            2.74030738e+02},
                                           {1.86082965e+02,
                                            -7.20776253e+01,
                                            -1.09679302e+02,
                                            1.71435644e+02,
                                            -2.21287907e+02,
                                            -6.18715162e+01},
                                           {-1.26501061e+03,
                                            4.71033201e+02,
                                            -6.47990662e+02,
                                            -2.21287907e+02,
                                            2.84983658e+03,
                                            4.50123668e+02},
                                           {-1.61766484e+02,
                                            1.30485369e+03,
                                            2.74030738e+02,
                                            -6.18715162e+01,
                                            4.50123668e+02,
                                            1.30347461e+03}});
    }

    if (color.compare("yellow") == 0)
    {
        params.hefts =
            arma::rowvec({0.08538001, 0.35383581, 0.03215281, 0.52863137});
        params.means = arma::mat(
            {{109.94035732, 249.92285007, 255., 29., 145.05964268, 255.},
             {0., 197.69181877, 181.79563961, 32.39700857, 255., 197.69181877},
             {54.96443433,
              207.11074053,
              215.8557993,
              28.29323513,
              194.7721969,
              222.50044879},
             {83.8924051, 249., 255., 29., 171.1075949, 255.}});

        params.means = params.means.t();  // to store info in a column vector
                                          // for each single gaussian

        params.fcovs = arma::cube(6, 6, params.hefts.n_elem);

        params.fcovs.slice(0) = arma::mat({{1.40776445e+02,
                                            2.91917280e+00,
                                            3.09141051e-22,
                                            3.51165029e-23,
                                            -1.40776444e+02,
                                            3.09141051e-22},
                                           {2.91917280e+00,
                                            2.81454995e-01,
                                            6.97625906e-22,
                                            7.92677936e-23,
                                            -2.91917280e+00,
                                            6.97625906e-22},
                                           {3.09132990e-22,
                                            6.97625906e-22,
                                            1.00000000e-06,
                                            8.19663084e-23,
                                            4.06721325e-22,
                                            7.21379850e-22},
                                           {3.51164978e-23,
                                            7.92678067e-23,
                                            8.19663084e-23,
                                            1.00000000e-06,
                                            4.62052658e-23,
                                            8.19663084e-23},
                                           {-1.40776444e+02,
                                            -2.91917280e+00,
                                            4.06627104e-22,
                                            4.62044484e-23,
                                            1.40776445e+02,
                                            4.06721325e-22},
                                           {3.09009363e-22,
                                            6.97629370e-22,
                                            7.21379850e-22,
                                            8.19663084e-23,
                                            4.06721325e-22,
                                            1.00000000e-06}});

        params.fcovs.slice(1) = arma::mat({{1.00000000e-06,
                                            0.00000000e+00,
                                            0.00000000e+00,
                                            0.00000000e+00,
                                            0.00000000e+00,
                                            0.00000000e+00},
                                           {0.00000000e+00,
                                            2.48780977e+02,
                                            2.08272450e+02,
                                            2.82720404e+00,
                                            2.61174913e-25,
                                            2.48780976e+02},
                                           {0.00000000e+00,
                                            2.08272450e+02,
                                            2.14693386e+02,
                                            -3.63148550e+00,
                                            2.63640981e-25,
                                            2.08272450e+02},
                                           {0.00000000e+00,
                                            2.82720404e+00,
                                            -3.63148550e+00,
                                            1.01727599e+00,
                                            3.51307636e-26,
                                            2.82720404e+00},
                                           {0.00000000e+00,
                                            2.49822071e-25,
                                            2.55945064e-25,
                                            3.53762229e-26,
                                            1.00000000e-06,
                                            2.61174913e-25},
                                           {0.00000000e+00,
                                            2.48780976e+02,
                                            2.08272450e+02,
                                            2.82720404e+00,
                                            2.61174913e-25,
                                            2.48780977e+02}});

        params.fcovs.slice(2) = arma::mat({{2.26464509e+03,
                                            7.12217951e+02,
                                            7.88085785e+02,
                                            -5.45710648e+01,
                                            -2.36591152e+03,
                                            7.86853697e+02},
                                           {7.12217951e+02,
                                            1.28365918e+03,
                                            9.86624807e+02,
                                            5.52213167e+01,
                                            -5.72022595e+02,
                                            1.11779009e+03},
                                           {7.88085785e+02,
                                            9.86624807e+02,
                                            1.50721077e+03,
                                            -8.92769206e+01,
                                            -6.13665130e+02,
                                            1.30311230e+03},
                                           {-5.45710648e+01,
                                            5.52213167e+01,
                                            -8.92769206e+01,
                                            2.95716214e+01,
                                            5.28386277e+01,
                                            -3.08889790e+01},
                                           {-2.36591152e+03,
                                            -5.72022595e+02,
                                            -6.13665130e+02,
                                            5.28386277e+01,
                                            2.57620498e+03,
                                            -6.14568757e+02},
                                           {7.86853697e+02,
                                            1.11779009e+03,
                                            1.30311230e+03,
                                            -3.08889790e+01,
                                            -6.14568757e+02,
                                            1.33201836e+03}});

        params.fcovs.slice(3) = arma::mat({{1.92098520e+02,
                                            6.20804542e-22,
                                            6.33084548e-22,
                                            7.22634361e-23,
                                            -1.92098519e+02,
                                            6.33084548e-22},
                                           {6.20813469e-22,
                                            1.00000000e-06,
                                            1.88215255e-21,
                                            2.14963562e-22,
                                            1.26988626e-21,
                                            1.88215255e-21},
                                           {6.33084176e-22,
                                            1.88215255e-21,
                                            1.00000000e-06,
                                            2.19086540e-22,
                                            1.29431161e-21,
                                            1.91825204e-21},
                                           {7.22678999e-23,
                                            2.14963562e-22,
                                            2.19086540e-22,
                                            1.00000000e-06,
                                            1.47816745e-22,
                                            2.19086540e-22},
                                           {-1.92098519e+02,
                                            1.26972593e-21,
                                            1.29414375e-21,
                                            1.47797396e-22,
                                            1.92098520e+02,
                                            1.29430651e-21},
                                           {6.32970670e-22,
                                            1.88215255e-21,
                                            1.91825204e-21,
                                            2.19086540e-22,
                                            1.29431161e-21,
                                            1.00000000e-06}});
    }

    model.set_means(params.means);
    model.set_fcovs(params.fcovs);
    model.set_hefts(params.hefts);

    return model;
}

std::array<arma::gmm_full, FaceColor::N_COLORS> load_gmm_models_from_file(
    const std::string &filename)
{
    YAML::Node file = YAML::LoadFile(filename);

    std::array<arma::gmm_full, FaceColor::N_COLORS> segmentation_models;

    segmentation_models[FaceColor::RED] =
        update_gmm_for_color(FaceColor::RED, file, "red");
    segmentation_models[FaceColor::GREEN] =
        update_gmm_for_color(FaceColor::GREEN, file, "green");
    segmentation_models[FaceColor::BLUE] =
        update_gmm_for_color(FaceColor::BLUE, file, "blue");
    segmentation_models[FaceColor::MAGENTA] =
        update_gmm_for_color(FaceColor::MAGENTA, file, "magenta");
    segmentation_models[FaceColor::YELLOW] =
        update_gmm_for_color(FaceColor::YELLOW, file, "yellow");
    segmentation_models[FaceColor::CYAN] =
        update_gmm_for_color(FaceColor::CYAN, file, "cyan");

    return segmentation_models;
}

arma::gmm_full update_gmm_for_color(FaceColor color,
                                    const YAML::Node &doc,
                                    const std::string &color_name)
{
    std::cout << "\n\nUpdating for color " << color_name << std::endl;

    int n_components = doc[color_name]["weights"].size();
    int n_dim = doc[color_name]["mu"][0].size();
    ;
    arma::gmm_full model;
    model.reset(n_dim, n_components);

    // Updating Weights //
    //        n_components = doc[color_name]["weights"].size();
    arma::rowvec weights(n_components);
    for (int i = 0; i < n_components; i++)
    {
        weights[i] = doc[color_name]["weights"][i].as<double>();
    }

    model.set_hefts(weights);
    std::cout << "Weights \n" << weights << std::endl;

    // Updating Means //
    //        n_components = doc[color_name]["mu"].size();
    //        n_dim = doc[color_name]["mu"][0].size();
    arma::mat means(n_components, n_dim);
    for (int i = 0; i < n_components; i++)
    {
        arma::rowvec row(n_dim);
        for (int j = 0; j < n_dim; j++)
        {
            row[j] = doc[color_name]["mu"][i][j].as<double>();
        }
        means.row(i) = row;
    }
    means = means.t();
    model.set_means(means);
    std::cout << "Means \n" << means << std::endl;

    // Updating Sigmas //
    //        n_components = doc[color_name]["sigma"].size();
    //        n_dim = doc[color_name]["sigma"][0].size();
    arma::cube fcovs(n_dim, n_dim, n_components);

    for (int i = 0; i < n_components; i++)
    {
        arma::mat sigma(n_dim, n_dim);
        for (int j = 0; j < n_dim; j++)
        {
            arma::rowvec row(n_dim);
            for (int k = 0; k < n_dim; k++)
            {
                row[k] = doc[color_name]["sigma"][i][j][k].as<double>();
            }
            sigma.row(j) = row;
        }
        fcovs.slice(i) = sigma;
    }
    model.set_fcovs(fcovs);
    std::cout << "Sigmas\n " << fcovs << std::endl;

    return model;
}

}  // namespace trifinger_object_tracking
